# 4. 데이터베이스

## 4.1. 데이터베이스의 기본

+ **데이터베이스** : 일정한 규칙, 규약을 통해 저장되는 데이터 모음
+ **DBMS** : 데이터베이스를 제어, 관리하는 통합 시스템
  + 데이터베이스 안에 있는 데이터들은 정의된 쿼리 언어를 통해 CRUD 가능.
  + 실시간접근 및 동시 공유가 가능

### 4.1.1 엔터티

여러 개의 속성을 지닌 명사.

+ 약한 엔터티 : 다른 엔터티의 존재 여부에 종속적
+ 강한 엔터티 : 다른 엔터티의 존재 여부와 독립적

### 4.1.2 릴레이션

데이터베이스에서 정보를 구분해 저장하는 기본 단위. 엔터티에 관한 데이터를 DB는 릴레이션 하나에 담아서 관리함

+ 릴레이션을 관계형 DB에서는 테이블, NoSQL DB에서는 컬렉션이라고 함.
+ 관계형 데이터베이스 : ex) MySql. 레코드-테이블-DB의 구조
+ NoSql : ex) MongoDB. 도큐먼트-컬렉션-DB의 구조

### 4.1.3 속성

릴레이션에서 관리하는, 구체적이며 고유한 이름을 갖는 정보

### 4.1.4 도메인

릴레이션에 포함된 각 속성들이 가질 수 있는 값의 집합

ex) 속성 '성별' -> 도메인 {남, 여}

### 4.1.5 필드와 레코드

+ 필드
+ 레코드 : 테이블에 쌓이는 행 단위의 데이터. 튜플이라고도 함

### 4.1.6 관계

데이터베이스 내 여러 테이블 사이에서도 관계를 정의할 수 있음

+ 1:1 관계
+ 1:N 관계
+ N:M 관계

### 4.1.7 키

테이블 간의 관계를 조금 더 명확하게 하고 테이블 자체의 인덱스를 위해 설정된 장치.

+ 기본키(Primary Key) : 유일성과 최소성을 만족하는 키
  + 자연키 : 테이블을 만들었을 때 자연스럽게 중복되지 않는 속성을 키로 만든 것. 언젠가는 변하는 속성
  + 인조키 : 인위적으로 생성해 부여한 고유 식별자. 변하지 않음.
+ 외래키(Foreign Key) : 다른 테이블의 기본키를 그대로 참조하는 값. 개체와의 관계를 식별하는 데 사용함
  + 중복되어도 괜찮음
+ 후보키(Candidate Key) : 기본키가 될 수 있는 후보. 유일성과 최소성을 동시에 만족
+ 대체키(Alternate Key) : 후보키가 둘 이상일 때 하나를 기본키로 지정하고 남은 후보키들
+ 슈퍼키(Super Key) : 각 레코드를 유일하게 식별할 수 있는 유일성을 갖춘 키입니다.

## 4.2 ERD와 정규화 과정

ERD(Entity Relationship Diagram) : 릴레이션 간의 관계를 정의한 것. DB 구축의 가장 기초적 뼈대 역할을 함

+ ERD는 관계형 구조로 표현할 수 있는 데이터를 구성하는 데에는 유용하지만,비정형 데이터는 충분히 표현할 수 없다는 단점을 가짐

### 4.2.3 정규화 과정

릴레이션 간의 잘못된 종속 관계로 인해 일어난 DB의 이상 현상(Anomaly)을 해결하거나, 저장 공간을 효율적으로 사용하기 위해 릴레이션을 여러 개로 분리하는 과정. 정규형 원칙을 기반으로 정규형을 만들어가는 과정이며, 그 정도는 정규형(NF, Normal Form)으로 표현함.

+ 정규형 원칙
  + 같은 의미를 표현하는 릴레이션이라도 좀 더 좋은 구조로 만들어야 함.
  + 자료의 중복성은 감소.
  + 독립적인 관계는 별개의 릴레이션으로 표현
  + 각 릴레이션은 독립적인 표현이 가능해야 함
+ 정규화의 장점
  + DB 변경 시 이상 현상을 제거 가능
  + 정규화된 DB 구조에서는 새로운 데이터 형의 추가로 인한 확장 시, 그 구조를 변경하지 않아도 되거나 일부만 변경해도 됨
  + DB와 연동된 응용 프로그램에 최소한의 영향만을 미치게 됨
+ 정규화의 단점
  + 릴레이션의 분해로 인해 릴레이션 간의 JOIN 연산이 많아짐
  + 쿼리 응답 시간이 느려질 수도 있음
  + 데이터 처리 속도에 변화가 생길 수 있음
  + 많은 JOIN으로 성능 저하가 일어나면 반 정규화를 적용할 수도 있음

+ 기본 정규형
  + 제 1 정규형
    + 릴레이션의 모든 도메인이 더 이상 분해될 수 없는 원자값으로만 구성되어야 함
    + 한 기본키에 대해 둘 이상의 값을 가지는 반복 집합이 있어서는 안되며, 만약 반복 집합이 있다면 제거해야 함
      + 각 컬럼은 한 속성만을 가져야 한다.
      + 한 컬럼은 같은 종류나 타입의 값을 가져야 함
      + 각 컬럼이 유일한 이름을 가져야 함
      + 칼럼의 순서는 상관 없어야 함
  + 제 2 정규형
    + 릴레이션이 제 1 정규형이고 부분 함수의 종속성을 제거한 형태
    + 부분 함수의 종속성 제거
      + 기본키가 아닌 모든 속성이 기본키에 완전 함수 종속적
      + == 기본키의 부분집합이 결정자가 되어서는 안된다.
  + 제 3 정규형
    + 제 2 정규형이면서, 기본키가 아닌 모든 속성이 이행적 함수 종속(transitive FD)을 만족하지 않는 상태
  + 보이스/코드 정규형
    + 제 3 정규형이면서, 결정자가 후보키가 아닌 함수 종속 관계를 제거해 릴레이션의 함수 종속 관계에서 모든 결정자가 후보키인 상태
    + 결정자 :함수 종속 관계에서 특정 종속자(dependent)를 결정짓는 요소.
+ 고급 정규형
  + 제 4 정규형
    + 보이스/코드 정규형이면서 다치 종속이 없는 상태
    + 다치 종속
      + A->B일 때 한 A 값에 여러 B값이 존재하는 경우
      + 최소 세 개의 칼럼이 존재해야 함
      + R(A, B, C)가 있을 때, A, B 사이에 다치 종속성이 있으면서 B, C는 독립적인 경우
  + 제 5 정규형
    + 중복을 제거하기 위해 분해할 수 있을 만큼 전부 분해하는 것
    + 제 4 정규형이면서 조인 종속이 없어야 함
      + 조인 종속 : 한 릴레이션을 여러 개의 릴레이션으로 무손실 분해 했다가 다시 결합할 수 있다면 조인 종속이라 함
    + 조인 연산을 했을 때 손실이 없어야 함
    + 현실의 DB는 제 5 정규형을 사용하지 않음

